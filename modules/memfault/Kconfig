#
# Copyright (c) 2021 Nordic Semiconductor ASA
#
# SPDX-License-Identifier: LicenseRef-Nordic-5-Clause
#

if MEMFAULT

config MEMFAULT_USE_EXTRA_DEFS_FILE
        bool
        select MEMFAULT_METRICS_EXTRA_DEFS_FILE
        default y

config MEMFAULT_API_KEY
        string "Memfault API key"

config MEMFAULT_DEVICE_ID
        string "Memfault device ID"

config MEMFAULT_DEVICE_SERIAL_USE_IMEI
        bool "Use IMEI as Memfault device serial"
        depends on AT_CMD
        default y if BOARD_NRF9160DK_NRF9160NS || BOARD_THINGY91_NRF9160NS

config MEMFAULT_HW_VERSION
        string "Hardware version"
        default CONFIG_BOARD

config MEMFAULT_FW_TYPE
        string "Firmware type"
        default "nrf91-fw" if BOARD_NRF9160DK_NRF9160 || BOARD_THINGY91_NRF9160
        default "nrf91ns-fw" if BOARD_NRF9160DK_NRF9160NS || BOARD_THINGY91_NRF9160NS
        help
          Firmware type running on the board.

choice
	prompt "Firmware version generation method"
        default MEMFAULT_FW_VERSION_AUTO

config MEMFAULT_FW_VERSION_STATIC
        bool "Static firmware version"
        help
          Use statically configured firmware version, as opposed to an
          dynamically generated one.

config MEMFAULT_FW_VERSION_AUTO
        bool "Dynamic firmware version"
        help
          Use dyanimically generated firmware version. The version is
          re-generated on every compiler run.
endchoice

config MEMFAULT_FW_VERSION_PREFIX
        string "Firmware version prefix"
        depends on MEMFAULT_FW_VERSION_AUTO
        default "0.0.1+"
        help
          Prefix to use in front of automatically generated build version string.
          If the build version string is "a1b2c3d", the full firmware version
          will become "<prefix>a1b2c3d".

config MEMFAULT_INIT_PRIORITY
        int "memfault initialization priority"
        range AT_CMD_INIT_PRIORITY 99 if MEMFAULT_DEVICE_SERIAL_USE_IMEI
        default 90
        help
          If IMEI is used as device ID, the initialization priority must be
          greater than that of the AT command module.

config MEMFAULT_PROVISION_CERTIFICATES
        bool "Provision certificates on initalization"
        default y
        help
          Provision required TLS root certificates for connecting to Memfault's
          endpoints. If this option is disabled, the user is responsible for
          calling the appropriate Memfault APIs for provisioning the
          certificates before attempting to connect to Memfault servers.

config MEMFAULT_STACK_CHECK_INTERVAL
        int "Stack check interval in seconds"
        default 600
        help
          Stack checks are performed periodically. This configuration option
          can be used to change how often the stack check is performed.

config MEMFAULT_LTE_METRICS
        bool "Capture LTE metrics"
        select LTE_LC_TRACE
        depends on LTE_LINK_CONTROL

module = MEMFAULT_INTEGRATION
module-dep = LOG
module-str = Memfault integration library
source "${ZEPHYR_BASE}/subsys/logging/Kconfig.template.log_config"


endif # MEMFAULT